---
layout:     post
title:      "Linux命令：top"
subtitle:   " "
date:       2018-09-15
author:     "huailei"
header-img: "img/post-bg-linux-order.jpg"
tags:
    -Linux
    
---
>>> 温暖(live) --tiger

## 常用参数
Linux中`top`命令用于`实时显示process的动态`。  
top命令有一些常用的参数：
- **-d**: 改变显示的更新速度，或是在交谈式指令列按`s`。
- **-q**: 没有任何延时的显示速度，如果使用是以`superuser`的权限执行，则top以最高的优先序执行。
- **-c**: 显示完成的`command`。
- **-n**: 更新的次数，完成之后将会退出top。  
- **-p 139**: 显示进程Id为139的进程信息，CPU，内存占用率等。   

## 输出信息介绍
！[top命令输出信息](/img/in-post/post-linux/post-top-1.png)  
我们从图片中可以看到这些信息，首先第一行，当前时间，系统运行时间，当前登录用户，最后一项是系统负载，三个数值分别是1分钟，5分钟，15分钟到现在的平均值。第二行，任务的总数，zombie是僵尸进程数。第三行，`0.6%us`:用户空间占用CPU百分比，`0.3%sy`:内核空间占用CPU百分比，`0.1%ni`:用户进程空间内改变过优先级的进程占用CPU百分比，`98.9%id`:空闲CPU百分比，`0.0%wa`:等待输入输出的CPU时间百分比，`0.0%hi`: Hardware IRQ，`0.0%si`: Software IRQ。另外，IRQ: IRQ全称为Interrupt Request，即是“中断请求”的意思。st(Steal Time): stole time 的缩写，该项指标只对虚拟机有效，表示分配给当前虚拟机的CPU 时间之中，被同一台物理机上的其他虚拟机偷走的时间百分比。  
后面两行根据名字就能看出相应的意思，这里介绍一下`buffer`和`cache`的区别:  
- 可用内存 = 系统`free memory + buffers + cached`。
- `buffers`是指用来给块设备做的缓冲大小，他只记录文件系统的`metadata`以及`tracking in-flight pages`。
- `cached`是用来给文件做缓冲
那就是说：`buffers`是用来存储，目录里面有什么内容，权限等等。而`cached`直接用来存储我们打开的文件。  
![top命令输出信息](/img/in-post/post-linux/post-top-2.png)  
这些字段的意思我们可以从下面两张图中了解：
![top命令输出信息](/img/in-post/post-linux/post-top-3.png)
![top命令输出信息](/img/in-post/post-linux/post-top-4.png)
- 通过 `f `键可以选择显示的内容。按`f`键之后会显示列的列表，按`a-z`即可显示或隐藏对应的列，最后按回车键确定。
- 按`o`键可以改变列的显示顺序。按小写的`a-z`可以将相应的列向右移动，而大写的`A-Z`可以将相应的列向左移动，最后按回车键确定。
- 按大写的`F`或`O`键，然后按`a-z`可以将进程按照相应的列进行排序。而大写的`R`键可以将当前的排序倒转。  

## 常用交互命令
- **Ctrl+L**: 擦除并且重写屏幕。
- **h**或者**?**: 显示帮助画面，给出一些简短的命令总结说明。
- **k**： 终止一个进程。系统将提示用户输入需要终止的进程PID，以及需要发送给该进程什么样的信号。一般的终止进程可以使用`15信号`；如果不能正常结束那就使用`信号9`强制结束该进程。默认值是`信号15`。在安全模式中此命令被屏蔽。
- **i**： 忽略闲置和僵死进程。这是一个开关式命令。
- **q**： 退出程序。
- **r**： 重新安排一个进程的优先级别。系统提示用户输入需要改变的进程PID以及需要设置的进程优先级值。输入一个正值将使优先级降低，反之则可以使该进程拥有更高的优先权。默认值是`10`。
- **S**： 切换到累计模式。
- **s**： 改变两次刷新之间的延迟时间。系统将提示用户输入新的时间，单位为`s`。如果有小数，就换算成`ms`。输入`0`值则系统将不断刷新，默认值是`5s。需要注意的是如果设置太小的时间，很可能会引起不断刷新，从而根本来不及看清显示的情况，而且系统负载也会大大增加。
- **f**或者**F**： 从当前显示中添加或者删除项目。
- **o**或者**O**： 改变显示项目的顺序。
- **l**： 切换显示`平均负载`和`启动时间信息`。
- **m**： 切换显示`内存`信息。
- **t**： 切换显示`进程`和`CPU`状态信息。
- **c**： 切换显示`命令名称`和`完整命令行`。
- **M**： 根据驻留内存大小进行排序。
- **P**： 根据CPU使用百分比大小进行排序。
- **T**： 根据时间/累计时间进行排序。
- **W**： 将当前设置写入`~/.toprc`文件中。这是写top配置文件的推荐方法。
